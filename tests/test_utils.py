import pytest

from entsoe_client.utils import yield_date_range


@pytest.mark.parametrize(
    "start, end, freq, expected",
    [
        (
            "20230101",
            "20250102",
            "1y",
            [
                ("2023-01-01T00:00:00+00:00", "2024-01-01T00:00:00+00:00"),
                ("2024-01-01T00:00:00+00:00", "2025-01-01T00:00:00+00:00"),
                ("2025-01-01T00:00:00+00:00", "2025-01-02T00:00:00+00:00"),
            ],
        ),
        (
            "20230101",
            "20230302",
            "1mo",
            [
                ("2023-01-01T00:00:00+00:00", "2023-02-01T00:00:00+00:00"),
                ("2023-02-01T00:00:00+00:00", "2023-03-01T00:00:00+00:00"),
                ("2023-03-01T00:00:00+00:00", "2023-03-02T00:00:00+00:00"),
            ],
        ),
        (
            "20230101",
            "20230103 23:00:00",
            "1d",
            [
                ("2023-01-01T00:00:00+00:00", "2023-01-02T00:00:00+00:00"),
                ("2023-01-02T00:00:00+00:00", "2023-01-03T00:00:00+00:00"),
                ("2023-01-03T00:00:00+00:00", "2023-01-03T23:00:00+00:00"),
            ],
        ),
        (
            "20230101",
            "20230101 02:45:00",
            "1h",
            [
                ("2023-01-01T00:00:00+00:00", "2023-01-01T01:00:00+00:00"),
                ("2023-01-01T01:00:00+00:00", "2023-01-01T02:00:00+00:00"),
                ("2023-01-01T02:00:00+00:00", "2023-01-01T02:45:00+00:00"),
            ],
        ),
        (
            "20230101",
            "20230101 00:02:45",
            "1m",
            [
                ("2023-01-01T00:00:00+00:00", "2023-01-01T00:01:00+00:00"),
                ("2023-01-01T00:01:00+00:00", "2023-01-01T00:02:00+00:00"),
                ("2023-01-01T00:02:00+00:00", "2023-01-01T00:02:45+00:00"),
            ],
        ),
        (
            "20230101",
            "20230101 00:00:02",
            "1s",
            [
                ("2023-01-01T00:00:00+00:00", "2023-01-01T00:00:01+00:00"),
                ("2023-01-01T00:00:01+00:00", "2023-01-01T00:00:02+00:00"),
            ],
        ),
    ],
)
def test_yield_date_range(start, end, freq, expected):
    result = list(yield_date_range(start, end, freq))
    assert result == expected
